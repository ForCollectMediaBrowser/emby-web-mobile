define(['jqmwidget'],function(){var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;$.extend($.mobile,{getAttribute:function(element,key){var data;element=element.jquery?element[0]:element;if(element&&element.getAttribute){data=element.getAttribute("data-"+key);}
try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?JSON.parse(data):data;}catch(err){}
return data;}});$.widget("mobile.table",{options:{enhanced:false},_create:function(){if(!this.options.enhanced){this.element.addClass("ui-table");}
$.extend(this,{headers:undefined,allHeaders:undefined});this._refresh(true);},_setHeaders:function(){var trs=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children();this.allHeaders=this.headers.add(trs.children());},refresh:function(){this._refresh();},rebuild:$.noop,_refresh:function(){var table=this.element,trs=table.find("thead tr");this._setHeaders();trs.each(function(){var columnCount=0;$(this).children().each(function(){var span=parseInt(this.getAttribute("colspan"),10),selector=":nth-child("+(columnCount+1)+")",j;this.setAttribute("data-colstart",columnCount+1);if(span){for(j=0;j<span-1;j++){columnCount++;selector+=", :nth-child("+(columnCount+1)+")";}}
$(this).data("cells",table.find("tr").not(trs.eq(0)).not(this).children(selector));columnCount++;});});}});$.widget("mobile.table",$.mobile.table,{options:{mode:"reflow"},_create:function(){this._super();if(this.options.mode!=="reflow"){return;}
if(!this.options.enhanced){this.element.addClass("ui-table-reflow");this._updateReflow();}},rebuild:function(){this._super();if(this.options.mode==="reflow"){this._refresh(false);}},_refresh:function(create){this._super(create);if(!create&&this.options.mode==="reflow"){this._updateReflow();}},_updateReflow:function(){var table=this,opts=this.options;$(table.allHeaders.get().reverse()).each(function(){var cells=$(this).data("cells"),colstart=$.mobile.getAttribute(this,"colstart"),hierarchyClass=cells.not(this).filter("thead th").length&&" ui-table-cell-label-top",contents=$(this).clone().contents(),iteration,filter;if(contents.length>0){if(hierarchyClass){iteration=parseInt(this.getAttribute("colspan"),10);filter="";if(iteration){filter="td:nth-child("+iteration+"n + "+(colstart)+")";}
table._addLabels(cells.filter(filter),"ui-table-cell-label"+hierarchyClass,contents);}else{table._addLabels(cells,"ui-table-cell-label",contents);}}});},_addLabels:function(cells,label,contents){if(contents.length===1&&contents[0].nodeName.toLowerCase()==="abbr"){contents=contents.eq(0).attr("title");}
cells.not(":has(b."+label+")").prepend($("<b class='"+label+"'></b>").append(contents));}});});